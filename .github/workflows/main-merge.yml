name: Main merge
on:
  push:
    branches:
      - main

permissions:
  packages: write

jobs:
  verification:
    name: Verification
    uses: ./.github/workflows/reusable-verification.yml
    secrets: inherit

  build_and_push:
    name: Build & Push
    uses: ./.github/workflows/build-and-push-components-release.yml
    with:
      image_name: ghcr.io/wewanttocontributetovmclarity//${{ matrix.target }}
      image_tag: latest
